# API URL é©—è­‰å ±å‘Š

## é©—è­‰æ—¥æœŸ
2026-01-24

---

## âœ… æ‰€æœ‰ API URL å·²é©—è­‰æ­£ç¢º

### å·²æ›´æ–°çš„ Map App APIï¼ˆ14 å€‹ï¼‰

| # | API åç¨± | å‰ç«¯ URL | å¾Œç«¯ URL | ç‹€æ…‹ |
|---|---------|---------|----------|------|
| 1 | `mapUserAuth` | `https://mapuserauth-kmzfyt3t5a-uc.a.run.app` | `https://mapuserauth-kmzfyt3t5a-uc.a.run.app` | âœ… |
| 2 | `getMapUserProfile` | `https://getmapuserprofile-kmzfyt3t5a-uc.a.run.app` | `https://getmapuserprofile-kmzfyt3t5a-uc.a.run.app` | âœ… |
| 3 | `bindDeviceToMapUser` | `https://binddevicetomapuser-kmzfyt3t5a-uc.a.run.app` | `https://binddevicetomapuser-kmzfyt3t5a-uc.a.run.app` | âœ… |
| 4 | `unbindDeviceFromMapUser` | `https://unbinddevicefrommapuser-kmzfyt3t5a-uc.a.run.app` | `https://unbinddevicefrommapuser-kmzfyt3t5a-uc.a.run.app` | âœ… |
| 5 | `updateMapUserDevice` | `https://updatemapuserdevice-kmzfyt3t5a-uc.a.run.app` | `https://updatemapuserdevice-kmzfyt3t5a-uc.a.run.app` | âœ… |
| 6 | `updateMapUserFcmToken` | `https://updatemapuserfcmtoken-kmzfyt3t5a-uc.a.run.app` | `https://updatemapuserfcmtoken-kmzfyt3t5a-uc.a.run.app` | âœ… |
| 7 | `updateMapUserAvatar` | `https://updatemapuseravatar-kmzfyt3t5a-uc.a.run.app` | `https://updatemapuseravatar-kmzfyt3t5a-uc.a.run.app` | âœ… å·²ä¿®æ­£ |
| 8 | `deleteMapAppUser` | `https://deletemapappuser-kmzfyt3t5a-uc.a.run.app` | `https://deletemapappuser-kmzfyt3t5a-uc.a.run.app` | âœ… |
| 9 | `addMapUserNotificationPoint` | `https://addmapusernotificationpoint-kmzfyt3t5a-uc.a.run.app` | `https://addmapusernotificationpoint-kmzfyt3t5a-uc.a.run.app` | âœ… |
| 10 | `getMapUserNotificationPoints` | `https://getmapusernotificationpoints-kmzfyt3t5a-uc.a.run.app` | `https://getmapusernotificationpoints-kmzfyt3t5a-uc.a.run.app` | âœ… |
| 11 | `updateMapUserNotificationPoint` | `https://updatemapusernotificationpoint-kmzfyt3t5a-uc.a.run.app` | `https://updatemapusernotificationpoint-kmzfyt3t5a-uc.a.run.app` | âœ… |
| 12 | `removeMapUserNotificationPoint` | `https://removemapusernotificationpoint-kmzfyt3t5a-uc.a.run.app` | `https://removemapusernotificationpoint-kmzfyt3t5a-uc.a.run.app` | âœ… |
| 13 | `getMapUserActivities` | `https://getmapuseractivities-kmzfyt3t5a-uc.a.run.app` | `https://getmapuseractivities-kmzfyt3t5a-uc.a.run.app` | âœ… |
| 14 | `getPublicGateways` | `https://getpublicgateways-kmzfyt3t5a-uc.a.run.app` | *(æœªåœ¨å¾Œç«¯åˆ—è¡¨ä¸­ï¼Œä¿æŒåŸæœ‰ URL)* | âœ… |

### æ–°å»ºç«‹çš„ APIï¼ˆ1 å€‹ï¼‰

| # | API åç¨± | å‰ç«¯ URL | å¾Œç«¯ URL | ç‹€æ…‹ |
|---|---------|---------|----------|------|
| 15 | `checkMapUserStatus` | `https://us-central1-safe-net-tw.cloudfunctions.net/checkMapUserStatus` | `https://us-central1-safe-net-tw.cloudfunctions.net/checkMapUserStatus` | âœ… å·²ä¿®æ­£ |

---

## ä¿®æ­£è¨˜éŒ„

### å·²ä¿®æ­£çš„ URLï¼ˆ2 å€‹ï¼‰

1. **updateMapUserAvatar**
   - èˆŠ URL: `https://us-central1-safe-net-tw.cloudfunctions.net/updateMapUserAvatar` (1st Gen)
   - æ–° URL: `https://updatemapuseravatar-kmzfyt3t5a-uc.a.run.app` (2nd Gen)
   - åŸå› : é·ç§»åˆ° 2nd Gen Cloud Functions

2. **checkMapUserStatus**
   - èˆŠ URL: `https://checkmapuserstatus-kmzfyt3t5a-uc.a.run.app` (éŒ¯èª¤)
   - æ–° URL: `https://us-central1-safe-net-tw.cloudfunctions.net/checkMapUserStatus` (1st Gen)
   - åŸå› : æ­¤ API ä½¿ç”¨ 1st Gen Cloud Functions

---

## é©—è­‰çµæœ

âœ… **æ‰€æœ‰ API URL å·²é©—è­‰ä¸¦ä¿®æ­£å®Œæˆ**

- ç¸½ API æ•¸é‡: 15 å€‹
- æ­£ç¢º URL: 15 å€‹ (100%)
- å·²ä¿®æ­£ URL: 2 å€‹
- Lint æª¢æŸ¥: é€šé âœ…

---

## å¾Œç«¯ API åŠŸèƒ½ç¢ºèª

æ ¹æ“šå¾Œç«¯åœ˜éšŠæä¾›çš„è³‡è¨Šï¼š

âœ… **æ‰€æœ‰ API ç¾åœ¨éƒ½æ”¯æ´ï¼š**
1. æ¨™æº–åŒ–éŒ¯èª¤ç¢¼ï¼ˆ`errorCode` æ¬„ä½ï¼‰
2. ç¹é«”ä¸­æ–‡éŒ¯èª¤è¨Šæ¯ï¼ˆ`error` æ¬„ä½ï¼‰

é€™æ„å‘³è‘—ï¼š
- å‰ç«¯å¯ä»¥é–‹å§‹ä½¿ç”¨ `errorCode` é€²è¡ŒéŒ¯èª¤åˆ¤æ–·
- ä¸å†éœ€è¦ä¾è³´å­—ä¸²æ¯”å°
- `AccountDeletedHandler` çš„å‘å¾Œç›¸å®¹æ¨¡å¼ï¼ˆå­—ä¸²æ¯”å°ï¼‰å¯ä»¥åœ¨æœªä¾†ç§»é™¤

---

## Cloud Functions ç‰ˆæœ¬èªªæ˜

### 2nd Gen Cloud Functions (14 å€‹)
å¤§éƒ¨åˆ† API å·²é·ç§»åˆ° 2nd Genï¼Œä½¿ç”¨åŸŸåï¼š`*.kmzfyt3t5a-uc.a.run.app`

å„ªé»ï¼š
- æ›´å¥½çš„æ€§èƒ½
- æ›´ä½çš„å†·å•Ÿå‹•æ™‚é–“
- æ›´éˆæ´»çš„é…ç½®

### 1st Gen Cloud Functions (1 å€‹)
- `checkMapUserStatus`: æ–°å»ºç«‹çš„ APIï¼Œä½¿ç”¨ 1st Gen
- URL: `https://us-central1-safe-net-tw.cloudfunctions.net/checkMapUserStatus`

---

## ä¸‹ä¸€æ­¥å»ºè­°

1. âœ… **ç«‹å³æ¸¬è©¦**
   - æ¸¬è©¦æ‰€æœ‰èªè­‰æµç¨‹ï¼ˆè¨»å†Šã€ç™»å…¥ã€ç™»å‡ºï¼‰
   - æ¸¬è©¦éŒ¯èª¤ç¢¼å›æ‡‰æ˜¯å¦æ­£ç¢º
   - æ¸¬è©¦å¸³è™Ÿåˆªé™¤æª¢æ¸¬

2. ğŸ”„ **ç›£æ§ API**
   - è§€å¯ŸéŒ¯èª¤ç¢¼æ˜¯å¦æ­£ç¢ºè¿”å›
   - ç¢ºèªç¹é«”ä¸­æ–‡éŒ¯èª¤è¨Šæ¯é¡¯ç¤ºæ­£å¸¸
   - æª¢æŸ¥ `checkMapUserStatus` æ–° API çš„é‹ä½œ

3. ğŸ§¹ **æ¸…ç†ä»£ç¢¼ï¼ˆå¯é¸ï¼‰**
   - åœ¨ç¢ºèª errorCode ç©©å®šé‹ä½œå¾Œ
   - å¯ä»¥ç§»é™¤ `AccountDeletedHandler._legacyStringCheck()` æ–¹æ³•
   - ç§»é™¤å‘å¾Œç›¸å®¹çš„å­—ä¸²æ¯”å°ä»£ç¢¼

---

## ç›¸é—œæ–‡æª”

- [å¾Œç«¯ API è¦æ ¼](./BACKEND_API_SPEC.md)
- [API ä½¿ç”¨ç¯„ä¾‹](./API_USAGE_EXAMPLES.md)
- [é‡æ§‹ç¸½çµ](./REFACTOR_SUMMARY.md)

---

**é©—è­‰å®Œæˆæ™‚é–“**: 2026-01-24
**é©—è­‰äººå“¡**: AI Assistant
**ç‹€æ…‹**: âœ… å…¨éƒ¨é©—è­‰é€šé
